# OpenVPN server configuration file
# Generated by Chef - local changes will be overwritten!

# Please refer to the OpenVPN documentation for details on
# configuration settings.

<%- @config.sort.each do |key, values| -%>
<%- [*values].each do |value| -%>
<%- next if value.nil? -%>
<%= key %> <%=
  case value
  when String
    value
  when TrueClass
    1
  when FalseClass
    0
  else
    value
  end
%>
<%- end -%>
<%- end -%>

<%- unless @config_extras.empty? -%>
# Extra settings that don't have a value
<%- @config_extras.sort.each do |option| -%>
<%= option %>
<%- end -%>
<%- end -%>

<% unless @push_routes.empty? %>
# additional routes to push to clients
  <% @push_routes.each do |route| %>
push "route <%= route %>"
  <% end %>
<% end %>

<% unless @push_options.empty? %>
# additional options to push to clients
  <% render_push_options(@push_options).each do |line| -%>
<%= line %>
  <% end -%>
<% end %>

<% if @ldap_auth['enabled'] %>
#
# Setup OpenVPN-Auth-LDAP
#

plugin /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so <%= @ldap_auth['config_file'] %>
<% end %>
